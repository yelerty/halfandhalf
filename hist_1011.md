⏺ HalfAndHalf 앱 동작 방식 자세한 설명

  1. 앱 시작 & 인증 흐름

  앱 실행 시

  사용자가 앱 실행
      ↓
  _layout.tsx에서 Firebase 인증 상태 체크
      ↓
  로그인 안됨? → login 화면으로 이동
  로그인 됨? → (tabs) 메인 화면으로 이동

  로그인/회원가입 (login.tsx)

  1. 회원가입:
    - 이메일 + 비밀번호 입력
    - Firebase Authentication에 계정 생성
    - 자동으로 메인 화면 이동
  2. 로그인:
    - 이메일 + 비밀번호 입력
    - Firebase에서 인증 확인
    - 성공하면 메인 화면 이동

  ---
  2. 메인 화면 구조 (Tabs)

  하단에 4개 탭이 있습니다:

  📱 홈 탭 (index.tsx)

  실시간 게시글 목록 표시

  앱 실행
      ↓
  Firestore "posts" 컬렉션 구독 (실시간)
      ↓
  게시글 데이터 받아옴 (최신순 정렬)
      ↓
  화면에 리스트로 표시:
    - 매장 이름 (예: 코스트코 양재점)
    - 시간대 (예: 14:00 - 16:00)
    - 나눔 물건 (예: 키친타올 12롤)
    - 작성자 이메일
      ↓
  + 버튼 클릭 → 게시글 작성 화면으로

  실시간 업데이트:
  - 다른 사용자가 게시글 작성 → 자동으로 목록에 추가됨
  - 게시글 삭제 → 자동으로 목록에서 제거됨

  ✍️ 내 게시글 탭 (my-posts.tsx)

  - 현재: 빈 화면 ("등록한 게시글이 없습니다")
  - 향후: 내가 작성한 게시글만 필터링해서 표시

  💬 채팅 탭 (chats.tsx)

  - 현재: 빈 화면 ("채팅방이 없습니다")
  - 향후: 매칭된 사람들과의 채팅방 목록

  👤 프로필 탭 (profile.tsx)

  - 현재 로그인한 이메일 표시
  - 로그아웃 버튼 → 클릭 시 로그인 화면으로

  ---
  3. 게시글 작성 흐름 (create-post.tsx)

  홈 화면에서 + 버튼 클릭
      ↓
  게시글 작성 화면 (모달)
      ↓
  사용자 입력:
    1. 매장 (예: 코스트코 양재점)
    2. 나눔 물건 (예: 키친타올 12롤)
    3. 시작 시간 (예: 14:00)
    4. 종료 시간 (예: 16:00)
      ↓
  "등록하기" 버튼 클릭
      ↓
  Firestore에 저장되는 데이터:
    {
      store: "코스트코 양재점",
      item: "키친타올 12롤",
      startTime: "14:00",
      endTime: "16:00",
      userId: "현재 로그인한 사용자 ID",
      userEmail: "user@example.com",
      createdAt: 2025-10-11 00:30:00
    }
      ↓
  저장 성공 → "게시글이 등록되었습니다!" 알림
      ↓
  이전 화면(홈)으로 돌아감
      ↓
  홈 화면 자동으로 새 게시글 표시 (실시간)

  ---
  4. Firebase 데이터베이스 구조

  Firestore 컬렉션: posts

  posts (컬렉션)
    └─ [자동생성 문서ID]
        ├─ store: "코스트코 양재점"
        ├─ item: "키친타올 12롤"
        ├─ startTime: "14:00"
        ├─ endTime: "16:00"
        ├─ userId: "abc123..."
        ├─ userEmail: "user@example.com"
        └─ createdAt: Timestamp

    └─ [자동생성 문서ID]
        ├─ store: "이마트 트레이더스"
        ├─ item: "소고기 2kg"
        └─ ...

  Firebase Authentication (users)

  users
    └─ uid: "abc123..."
        ├─ email: "user@example.com"
        └─ createdAt: ...

  ---
  5. 실시간 동작 원리

  실시간 리스너 (onSnapshot)

  // index.tsx에서
  useEffect(() => {
    const q = query(collection(db, 'posts'), orderBy('createdAt', 'desc'));

    const unsubscribe = onSnapshot(q, (snapshot) => {
      // Firestore에서 변경사항 발생할 때마다 실행됨
      const postsData = snapshot.docs.map(doc => ({
        id: doc.id,
        ...doc.data()
      }));
      setPosts(postsData); // 화면 자동 업데이트
    });

    return unsubscribe; // 화면 떠날 때 구독 해제
  }, []);

  동작 방식:
  1. 앱 실행 → Firestore "posts" 컬렉션 구독 시작
  2. 누군가 게시글 추가 → Firestore가 앱에 알림
  3. 앱이 새 데이터 받음 → 화면 자동 업데이트
  4. 사용자는 새로고침 안해도 실시간으로 변경사항 확인

  ---
  6. 사용 시나리오 예시

  시나리오: 사용자 A와 B가 공동구매

  1. 사용자 A (홍길동):
  회원가입 → 로그인
  ↓
  홈 화면 → + 버튼 클릭
  ↓
  게시글 작성:
    - 매장: 코스트코 양재점
    - 물건: 키친타올 12롤
    - 시간: 14:00 - 16:00
  ↓
  등록 완료
  2. 사용자 B (김철수):
  앱 실행 → 홈 화면
  ↓
  실시간으로 홍길동의 게시글 자동 표시됨
  ↓
  "코스트코 양재점, 키친타올 12롤" 확인
  ↓
  게시글 클릭 (향후: 채팅 시작)
  ↓
  홍길동과 채팅으로 만날 시간/장소 조율
  ↓
  오프라인에서 만나서 구매 & 나눔

  ---
  7. 현재 구현된 기능 vs 아직 없는 기능

  ✅ 현재 작동:

  - 회원가입 / 로그인 / 로그아웃
  - 게시글 작성
  - 실시간 게시글 목록 조회
  - 사용자 인증 상태 관리

  ❌ 아직 미구현:

  - 매칭 기능: 같은 매장/물건/시간 사람 찾기
  - 채팅 기능: 1:1 실시간 채팅
  - 푸시 알림: 매칭되면 알림
  - 게시글 상세/수정/삭제
  - 지도 연동: 매장 위치 확인
  - 필터/검색: 원하는 매장/물건 검색
  - 프로필 편집: 닉네임, 사진 등

  ---
  8. 데이터 흐름 요약

  사용자 입력
      ↓
  React Native 앱 (프론트엔드)
      ↓
  Firebase SDK (firebase.ts)
      ↓
  Firebase 서버
      ├─ Authentication (인증)
      └─ Firestore (데이터베이스)
      ↓
  실시간 동기화
      ↓
  모든 앱에 자동 업데이트

  이 구조 덕분에 서버 코드 없이도 실시간 공동구매 매칭 앱이 작동합니다!
